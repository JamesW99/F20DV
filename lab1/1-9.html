<!-- Exercise 9: For the example above, to count how many of the names include ‘Mr.’ and ‘Mrs’ (or other). Also print out other details using other column header information, such as, how many passengers are ‘male’ and how many ‘female’.  -->
<!-- ref:
https://blog.csdn.net/u013967628/article/details/86569262#:~:text=promise%E4%B8%AD.-,then()%E6%96%B9%E6%B3%95promise%E7%9A%84%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%98%AF%E5%90%8C%E6%AD%A5%E6%89%A7%E8%A1%8C,onRejected%5D)%3B%20%E5%8F%82%E6%95%B0promise%20%E5%BF%85%E9%9C%80%E3%80%82
https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/then 
https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/match
-->


<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">
<head>
    <script src='https://d3js.org/d3.v7.min.js'></script>
</head>
Exercise 9:<br><br>


<script>
let titaniccsv = 'https://raw.githubusercontent.com/dsindy/kaggle-titanic/master/data/test.csv';
/*
PassengerId,Pclass,Name,Sex,Age,SibSp,Parch,Ticket,Fare,Cabin,Embarked
892,3,"Kelly, Mr. James",male,34.5,0,0,330911,7.8292,,Q
893,3,"Wilkes, Mrs. James (Ellen Needs)",female,47,1,0,363272,7,,S
894,2,"Myles, Mr. Thomas Francis",male,62,0,0,240276,9.6875,,Q
895,3,"Wirz, Mr. Albert",male,27,0,0,315154,8.6625,,S
*/

function match(data) {
    var mr = 0;
    var mrs = 0;
    var miss = 0;
    var ms = 0;
    var master = 0;
    var col = 0;
    var dona = 0;
    var dr = 0;
    var rev = 0;

    // match all known title
    data.forEach( function(d)  {
        // console.log(d.Name) ;
        if (d.Name.match(/Mrs./)){
            mrs +=1;
        } else if (d.Name.match(/Mr./)) {
            mr += 1;
        } else if (d.Name.match(/Miss./)){
            miss += 1;
        } else if (d.Name.match(/Ms./)){
            ms += 1;
        } else if (d.Name.match(/Master./)){
            master += 1;
        } else if (d.Name.match(/Col./)){
            col += 1;
        } else if (d.Name.match(/Dona./)){
            dona += 1;
        } else if (d.Name.match(/Dr./)){
            dr += 1;
        } else if (d.Name.match(/Rev./)){
            rev +=1;
        } else{
            console.log('Unknown title!')
        }
        
    })


    // match gender
    var male = 0;
    var female = 0;
    data.forEach( function(d)  {
        // console.log(d.Name) ;
        if (d.Sex === 'male'){
            male +=1;
        } else if (d.Sex === 'female') {
            female += 1;
        }  else{
            console.log('Unknown gender!')
        }
        
    })
    
    d3.select("body").append("p").text("Mr:" + mr);
    d3.select("body").append("p").text("Mrs:" + mrs);
    d3.select("body").append("p").text("Miss:" + miss);
    d3.select("body").append("p").text("Ms:" + ms);
    d3.select("body").append("p").text("Master:" + master);
    d3.select("body").append("p").text("Col:" + col);
    d3.select("body").append("p").text("Dona:" + dona);
    d3.select("body").append("p").text("Dr:" + dr);
    d3.select("body").append("p").text("Rev:" + rev);
    
    d3.select("body").append("p").text("=========================");
    
    d3.select("body").append("p").text("Male:" + male);
    d3.select("body").append("p").text("Female:" + female);


}

d3.csv(titaniccsv)
.then(match);

</script>

</html>